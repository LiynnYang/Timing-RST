# Devide & Merge Framework

This project is a novel learning-based divide and merge framework to solve large-scale routing instance.

## Code description

* Folder **algorithm**: the baseline algorithm code such as FLUTE and Geostenier.

* Folder **data**: the code of directed graph generating and dataset generating.

* Folder **flow_utils** : the tools code of Devide & Merge process such as RMST and devide process.

* Folder **models**: the gnn model.

* Folder **save**: the parameters saved.

* Folder **shared_so**: the Dynamic Link Library document generated by C plus plus. 

* Folder **utils**: Some sub-model used by GNN.

* python **main_flow**: the main flow of Devide & Merge process.

* python **merge_test**: eval the performance of merge.

* python **run**: the final document to execute the Framework.

* python **train_DDP**: the training document.

## Dependencies

* Python 3.8.0+

* PyTorch 1.11.0+

**Note**: All the commands below are  executed in the project root directory.

## Training

Start training process use the command: torchrun

```bash
sudo env PATH="$PATH" torchrun --nproc_per_node=2 train_DDP.py
```

## Testing

### 1. Merge a pair

You can run the following command to verify the performance of the model.

```bash
python merge_test.py --degree 40 --batch_size 128 --eval_size 10000
```

### 2. The Main Flow of Devide & Merge

```bash
python run.py --degree 4000 --direction 0
```

